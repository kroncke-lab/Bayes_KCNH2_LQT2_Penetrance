setwd("\\DESKTOP-PIGAQDK/Users/B/Box Sync/Box Sync/Kroncke_Lab/kcnh2/VariantDatabase/penetrancePrediction/")
setwd("/DESKTOP-PIGAQDK/Users/B/Box Sync/Box Sync/Kroncke_Lab/kcnh2/VariantDatabase/penetrancePrediction/")
setwd("\\DESKTOP-PIGAQDK\")
)
/
\
\:""
setwd("/Users/B/Box Sync/Box Sync/Kroncke_Lab/kcnh2/VariantDatabase/penetrancePrediction/")
setwd("Z:/B/Box Sync/Box Sync/Kroncke_Lab/")
# load all required libraries
library(caret)
install.packages("caret")
library(plotrix)
install.packages("plotrix")
install.packages("glmnet")
library(meta)
install.packages("meta")
install.packages("reshape2")
install.packages("psych")
install.packages("Hmisc")
install.packages("tableone")
install.packages("ggplot2")
install.packages("DBI")
library("DBI")
library("RSQLite")
install.packages("RSQLite")
install.packages("wCorr")
install.packages('rms')
install.packages("boot")
install.packages("leaps")
install.packages("car")
install.packages("reticulate")
install.packages("rootSolve")
install.packages("pROC")
install.packages("MALDIquant")
library(caret)
library(plotrix)
library(glmnet)
library(meta)
library(reshape2)
library(psych)
require(Hmisc)
library(tableone)
library(ggplot2)
library("DBI")
library("RSQLite")
library(wCorr)
library(rms)
library(boot)
library(leaps)
library(car)
library(reticulate)
library(rootSolve)
library(pROC)
library(wCorr)
library(MALDIquant)
load("C:/Users/KRONCKE/AppData/Local/Temp/prepared_data.RData")
View(lit.overlap.data)
View(cohort.data)
View(lit.cohort.data)
View(cohort.data)
View(cohort.data)
rm(d)
# Loading combined literature, gnomAD, and cohort dataset
load("lit_all_data_checkpoint.RData")
d<-d[d$total_carriers>0 & d$mut_type!="nonsense" & d$isoform=="A",]
d<-d[!is.na(d$var),]
mean.post <- (d$alpha + d$lqt2)/(d$alpha+d$beta+d$total_carriers)
mean.prior <- (d$alpha)/(d$alpha+d$beta)
lower.prior <- qbeta(0.025,d$alpha,d$beta)
higher.prior <- qbeta(0.975,d$alpha,d$beta)
lower.post <- qbeta(0.025,d$alpha+d$lqt2,d$beta+d$total_carriers-d$lqt2)
higher.post <- qbeta(0.975,d$alpha+d$lqt2,d$beta+d$total_carriers-d$lqt2)
forest.data.post <- data.frame(variant = d$var, mean=mean.post,
lower=lower.post, higher=higher.post, resnum=d$resnum, tc=d$total_carriers, lqt2=d$lqt2)
forest.data.post$group<-"posterior"
forest.data.prior <- data.frame(variant = d$var, mean=mean.prior,
lower=lower.prior, higher=higher.prior, resnum=d$resnum, tc=d$total_carriers, lqt2=d$lqt2)
forest.data.prior$group<-"prior"
forest.data<-rbind(forest.data.post, forest.data.prior)
forest.data<-forest.data[order(forest.data$resnum, forest.data$variant),]
forest.data$label<-""
forest.data[forest.data$group=="posterior","label"]<-paste(forest.data[forest.data$group=="posterior","lqt2"], "/", forest.data[forest.data$group=="posterior","tc"])
#define colours for dots and bars
dotCOLS = c("#866D4B","#000000")
barCOLS = c("#FFFFFF","#FFFFFF")
plotg <- function(a,b){
fd<-forest.data[a:b,]
png( paste("Plots/", a, "-",b,"pics.png",sep=""),res=300,height=10,width=10,units="in")
p<-ggplot(fd, aes(x=reorder(variant,-resnum), y=mean, ymin=lower, ymax=higher, col=group, fill=group)) +
geom_text(data=fd, aes(x=reorder(variant,-resnum), label=label)) +
#specify position here
geom_linerange(size=2,position=position_dodge(width = 1)) +
geom_hline(yintercept=1, lty=1) +
geom_hline(yintercept=0, lty=1) +
#specify position here too
geom_point(size=2, shape=21, colour="white", stroke = 0.5,position=position_dodge(width = 1)) +
scale_fill_manual(values=barCOLS)+
scale_color_manual(values=dotCOLS)+
scale_y_continuous(name="LQT2 Diagnosis Probability", limits = c(0, 1)) +
coord_flip() +
theme_minimal()
print(p)
dev.off()
}
sapply(1:30*50+1,function(x) plotg(x,x+49) )
knitr::opts_chunk$set(echo = TRUE)
library("nnet")
library("DBI")
library("RSQLite")
library(dplyr)
library(ggplot2)
library(ggpubr)
library(caret)
library(plotrix)
library(glmnet)
library(meta)
library(reshape2)
library(psych)
require(Hmisc)
library(tableone)
library(wCorr)
library(rms)
library(boot)
library(leaps)
library(car)
library(reticulate)
library(rootSolve)
library(pROC)
library(wCorr)
library(MALDIquant)
library(tidyverse)      # data manipulation and visualization
library(lubridate)      # easily work with dates and times
library(fpp2)           # working with time series data
library(zoo)            # working with time series data
library(latex2exp)
library(forestplot)
library(ggplot2)
setwd("/Users/KRONCKE/Box Sync/Kroncke_Lab/GitHub/Bayes_KCNH2_LQT2_Penetrance/")
source('func_dist_seq.R')
load("prepared_data.RData")
# Include distances between residue centroids from the structure of KV11.1 (KCNH2 protein product) PDB-ID: 5VA1
h2dist<-read.csv(file = "5va1.dists.txt", header = FALSE)
rm(d)
# Loading combined literature, gnomAD, and cohort dataset
load("lit_all_data_checkpoint.RData")
d<-d[d$total_carriers>0 & d$mut_type!="nonsense" & d$isoform=="A",]
d<-d[!is.na(d$var),]
mean.post <- (d$alpha + d$lqt2)/(d$alpha+d$beta+d$total_carriers)
mean.prior <- (d$alpha)/(d$alpha+d$beta)
lower.prior <- qbeta(0.025,d$alpha,d$beta)
higher.prior <- qbeta(0.975,d$alpha,d$beta)
lower.post <- qbeta(0.025,d$alpha+d$lqt2,d$beta+d$total_carriers-d$lqt2)
higher.post <- qbeta(0.975,d$alpha+d$lqt2,d$beta+d$total_carriers-d$lqt2)
forest.data.post <- data.frame(variant = d$var, mean=mean.post,
lower=lower.post, higher=higher.post, resnum=d$resnum, tc=d$total_carriers, lqt2=d$lqt2)
forest.data.post$group<-"posterior"
forest.data.prior <- data.frame(variant = d$var, mean=mean.prior,
lower=lower.prior, higher=higher.prior, resnum=d$resnum, tc=d$total_carriers, lqt2=d$lqt2)
forest.data.prior$group<-"prior"
forest.data<-rbind(forest.data.post, forest.data.prior)
forest.data<-forest.data[order(forest.data$resnum, forest.data$variant),]
forest.data$label<-""
forest.data[forest.data$group=="posterior","label"]<-paste(forest.data[forest.data$group=="posterior","lqt2"], "/", forest.data[forest.data$group=="posterior","tc"])
#define colours for dots and bars
dotCOLS = c("#866D4B","#000000")
barCOLS = c("#FFFFFF","#FFFFFF")
plotg <- function(a,b){
fd<-forest.data[a:b,]
png( paste("Plots/", a, "-",b,"pics.png",sep=""),res=300,height=10,width=10,units="in")
p<-ggplot(fd, aes(x=reorder(variant,-resnum), y=mean, ymin=lower, ymax=higher, col=group, fill=group)) +
geom_text(data=fd, aes(x=reorder(variant,-resnum), label=label)) +
#specify position here
geom_linerange(size=2,position=position_dodge(width = 1)) +
geom_hline(yintercept=1, lty=1) +
geom_hline(yintercept=0, lty=1) +
#specify position here too
geom_point(size=2, shape=21, colour="white", stroke = 0.5,position=position_dodge(width = 1)) +
scale_fill_manual(values=barCOLS)+
scale_color_manual(values=dotCOLS)+
scale_y_continuous(name="LQT2 Diagnosis Probability", limits = c(0, 1)) +
coord_flip() +
theme_minimal()
print(p)
dev.off()
}
sapply(1:30*50+1,function(x) plotg(x,x+49) )
sapply(0:30*50+1,function(x) plotg(x,x+49) )
