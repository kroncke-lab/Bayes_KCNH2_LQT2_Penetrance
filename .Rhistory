tmp.other<-data[!(data$mut_type %in% c("nucdel_frameshift", "nucins_frameshift", "nonsense",
"nonsene", "frameshift", "splice", "silent_splice",
"indel_splice", "largeDuplication", "largeDeletion",
"unknownSplice", "unknownframeshift", "intronic", "unknown",
"unknownFrameshift", "geneDeletion", "balancedTranslocation",
"stop_retained", "stop_lost", "unknownFrameshift_variant", "aadel", "aains")),
c("var", "lqt3",
"brs1", "unaff", "other")]
View(tmp.other)
View(d)
View(merged.everything)
tmp.other<-data[!(data$mut_type %in% c("nucdel_frameshift", "nucins_frameshift", "nonsense",
"nonsene", "frameshift", "splice", "silent_splice",
"indel_splice", "largeDuplication", "largeDeletion",
"unknownSplice", "unknownframeshift", "intronic", "unknown",
"unknownFrameshift", "geneDeletion", "balancedTranslocation",
"stop_retained", "stop_lost", "unknownFrameshift_variant", "aadel", "aains")),
c("var", "lqt3",
"brs1", "unaff", "other", "pos", "ref","alt")]
View(data)
merged.total<-merge(merged.total,tmp.other, all = T)
merged.everything<-merge(merged.lqt.brs, merged.total, all = T)
View(merged.everything)
tmpp<-d[,c("var","total_carriers","Structure")]
View(tmpp)
View(merged.lqt.brs)
View(tmpp)
load("CheckPoint_20.RData")
d[is.na(d$var),"var"]<-paste(d[is.na(d$var),"nativeAA"],d[is.na(d$var),"resnum"],d[is.na(d$var),"mutAA"],sep = "")
library("RSQLite")
setwd("/Users/KRONCKE/Box Sync/Kroncke_Lab/GitHub/Bayes_BrS1_Penetrance/variant_browser/")
con = dbConnect(SQLite(),
dbname="../VariantSCN5A-third-revision.db")
alltables = dbListTables(con)
my.data <- dbReadTable(con, 'VariantSCN5A')
my.data[my.data=='NA'] <- NA
data<-my.data
dbDisconnect(con)
data$gnomAD<-as.integer(data$gnomAD)
data$gnomAD[is.na(data$gnomAD)] <- 0
data$total_carriers<-data$unaff+data$lqt3+data$brs1+data$gnomAD
data[is.na(data$total_carriers),"total_carriers"] <- 0
tmp<-data[data$mut_type %in% c("nucdel_frameshift", "nucins_frameshift", "nonsense",
"nonsene", "frameshift", "splice", "silent_splice",
"indel_splice", "largeDuplication", "largeDeletion",
"unknownSplice", "unknownframeshift", "intronic", "unknown",
"unknownFrameshift", "geneDeletion", "balancedTranslocation",
"stop_retained", "stop_lost", "unknownFrameshift_variant", "aadel", "aains"),
c("var", "lqt3",
"brs1", "unaff", "other")]
tmp.other<-data[!(data$mut_type %in% c("nucdel_frameshift", "nucins_frameshift", "nonsense",
"nonsene", "frameshift", "splice", "silent_splice",
"indel_splice", "largeDuplication", "largeDeletion",
"unknownSplice", "unknownframeshift", "intronic", "unknown",
"unknownFrameshift", "geneDeletion", "balancedTranslocation",
"stop_retained", "stop_lost", "unknownFrameshift_variant", "aadel", "aains")),
c("var", "lqt3",
"brs1", "unaff", "other")]
# Manually Adjust:
tmp<-tmp[tmp$var!="c.2436 +12G>A ", ]
tmp<-tmp[tmp$var!="c.2582_2583delTT", ]
tmp<-tmp[tmp$var!="c.3390-1G>A",]
tmp<-tmp[tmp$var!="	c.3963+2C>T",]
tmp<-tmp[tmp$var!="c.3005_3012delCCAGCTGC",]
tmp[tmp$var=="p.M741_T742delinsI ","var"]<-"p.M741_T742delinsI"
nons<-read.csv("Brett_K_nonsense.csv")
nons<-nons[,c("ref", "pos", "alt", "var")]
nons$var<-as.character(nons$var)
nons$alt<-as.character(nons$alt)
nons$ref<-as.character(nons$ref)
indel<-read.csv("Brett_K_mis_non_indel_splice_adj.csv")
indel<-indel[,c("ref", "pos", "alt", "var")]
indel$var<-as.character(indel$var)
indel$alt<-as.character(indel$alt)
indel$ref<-as.character(indel$ref)
load("CheckPoint_20.RData")
d[is.na(d$var),"var"]<-paste(d[is.na(d$var),"nativeAA"],d[is.na(d$var),"resnum"],d[is.na(d$var),"mutAA"],sep = "")
brs<-d[,c("Structure", "brs1_penetrance", "ref", "pos", "alt", "var", "Function")]
brs$alt<-as.character(brs$alt)
brs$ref<-as.character(brs$ref)
names(brs)[1]<-"Structure_BrS"
load("CheckPoint_20_lqt3.RData")
d[is.na(d$var),"var"]<-paste(d[is.na(d$var),"nativeAA"],d[is.na(d$var),"resnum"],d[is.na(d$var),"mutAA"],sep = "")
lqt<-d[,c("Structure", "lqt3_penetrance", "ref", "pos", "alt", "var", "resnum")]
lqt$alt<-as.character(lqt$alt)
lqt$ref<-as.character(lqt$ref)
names(lqt)[1]<-"Structure_LQT"
merged.lqt.brs<-merge(brs,lqt, all = T)
merged.not.ided<-merged.lqt.brs[is.na(merged.lqt.brs$ref),
c("Structure_BrS", "Structure_LQT", "lqt3_penetrance",
"brs1_penetrance", "Function", "var")]
merged.lqt.brs<-merged.lqt.brs[!is.na(merged.lqt.brs$ref),]
merged.not.ided[merged.not.ided$var=="p.M741_T742delinsI ","var"]<-"p.M741_T742delinsI"
test<-merge(merged.not.ided, indel, all = T)
test<-unique(test)
test2<-merge(test, nons, all = T)
test2<-unique(test2)
merged.total<-merge(tmp,test2, all = T)
merged.total<-unique(merged.total)
merged.total<-merge(merged.total,tmp.other, all = T)
merged.everything<-merge(merged.lqt.brs, merged.total, all = T)
View(merged.everything)
tmpp<-d[,c("var","total_carriers","Structure")]
View(brs)
View(lqt)
View(merged.everything)
View(tmp.other)
View(merged.total)
merged.total<-merge(tmp,test2, all = T)
merged.total<-unique(merged.total)
View(merged.total)
test<-merge(merged.not.ided, indel, all = T)
test<-unique(test)
test2<-merge(test, nons, all = T)
test2<-unique(test2)
merged.total<-merge(tmp,test2, all = T)
merged.total<-unique(merged.total)
merged.everything<-merge(merged.lqt.brs, merged.total, all = T)
View(merged.everything)
merged.everything<-merge(merged.lqt.brs, tmp.other, all = T)
View(merged.everything)
View(d)
d[d$var=="H558R"]
d[d$var=="H558R",]
merged.everything[merged.everything$var=="H558R",]
mmerged.lqt.brs[merged.lqt.brs$var=="H558R",]
merged.lqt.brs[merged.lqt.brs$var=="H558R",]
brs[brs$var=="H558R",]
lqt[lqt$var=="H558R",]
View(brs)
merged.lqt.brs<-merge(brs,lqt, all = T)
View(merged.lqt.brs)
merged.lqt.brs<-merged.lqt.brs[!is.na(merged.lqt.brs$ref),]
View(test2)
merged.total<-merge(tmp,test2, all = T)
merged.total<-unique(merged.total)
View(merged.total)
merged.other<-merge(merged.lqt.brs, tmp.other, all = T)
View(merged.other)
View(tmp.other)
View(merged.lqt.brs)
View(merged.other)
View(tmp.other)
names(data$mut_type)
data$mut_type
library("RSQLite")
setwd("/Users/KRONCKE/Box Sync/Kroncke_Lab/GitHub/Bayes_BrS1_Penetrance/variant_browser/")
con = dbConnect(SQLite(),
dbname="../VariantSCN5A-third-revision.db")
alltables = dbListTables(con)
my.data <- dbReadTable(con, 'VariantSCN5A')
my.data[my.data=='NA'] <- NA
data<-my.data
dbDisconnect(con)
data$gnomAD<-as.integer(data$gnomAD)
data$gnomAD[is.na(data$gnomAD)] <- 0
data$total_carriers<-data$unaff+data$lqt3+data$brs1+data$gnomAD
data[is.na(data$total_carriers),"total_carriers"] <- 0
tmp<-data[data$mut_type %in% c("nucdel_frameshift", "nucins_frameshift", "nonsense",
"nonsene", "frameshift", "splice", "silent_splice",
"indel_splice", "largeDuplication", "largeDeletion",
"unknownSplice", "unknownframeshift", "intronic", "unknown",
"unknownFrameshift", "geneDeletion", "balancedTranslocation",
"stop_retained", "stop_lost", "unknownFrameshift_variant", "aadel", "aains"),
c("var", "lqt3",
"brs1", "unaff", "other")]
tmp.other<-data[!(data$mut_type %in% c("nucdel_frameshift", "nucins_frameshift", "nonsense",
"nonsene", "frameshift", "splice", "silent_splice",
"indel_splice", "largeDuplication", "largeDeletion",
"unknownSplice", "unknownframeshift", "intronic", "unknown",
"unknownFrameshift", "geneDeletion", "balancedTranslocation",
"stop_retained", "stop_lost", "unknownFrameshift_variant", "aadel", "aains", "synonymous")),
c("var", "lqt3",
"brs1", "unaff", "other")]
# Manually Adjust:
tmp<-tmp[tmp$var!="c.2436 +12G>A ", ]
tmp<-tmp[tmp$var!="c.2582_2583delTT", ]
tmp<-tmp[tmp$var!="c.3390-1G>A",]
tmp<-tmp[tmp$var!="	c.3963+2C>T",]
tmp<-tmp[tmp$var!="c.3005_3012delCCAGCTGC",]
tmp[tmp$var=="p.M741_T742delinsI ","var"]<-"p.M741_T742delinsI"
nons<-read.csv("Brett_K_nonsense.csv")
nons<-nons[,c("ref", "pos", "alt", "var")]
nons$var<-as.character(nons$var)
nons$alt<-as.character(nons$alt)
nons$ref<-as.character(nons$ref)
indel<-read.csv("Brett_K_mis_non_indel_splice_adj.csv")
indel<-indel[,c("ref", "pos", "alt", "var")]
indel$var<-as.character(indel$var)
indel$alt<-as.character(indel$alt)
indel$ref<-as.character(indel$ref)
load("CheckPoint_20.RData")
d[is.na(d$var),"var"]<-paste(d[is.na(d$var),"nativeAA"],d[is.na(d$var),"resnum"],d[is.na(d$var),"mutAA"],sep = "")
brs<-d[,c("Structure", "brs1_penetrance", "ref", "pos", "alt", "var", "Function")]
brs$alt<-as.character(brs$alt)
brs$ref<-as.character(brs$ref)
names(brs)[1]<-"Structure_BrS"
load("CheckPoint_20_lqt3.RData")
d[is.na(d$var),"var"]<-paste(d[is.na(d$var),"nativeAA"],d[is.na(d$var),"resnum"],d[is.na(d$var),"mutAA"],sep = "")
lqt<-d[,c("Structure", "lqt3_penetrance", "ref", "pos", "alt", "var", "resnum")]
lqt$alt<-as.character(lqt$alt)
lqt$ref<-as.character(lqt$ref)
names(lqt)[1]<-"Structure_LQT"
merged.lqt.brs<-merge(brs,lqt, all = T)
merged.not.ided<-merged.lqt.brs[is.na(merged.lqt.brs$ref),
c("Structure_BrS", "Structure_LQT", "lqt3_penetrance",
"brs1_penetrance", "Function", "var")]
merged.lqt.brs<-merged.lqt.brs[!is.na(merged.lqt.brs$ref),]
merged.not.ided[merged.not.ided$var=="p.M741_T742delinsI ","var"]<-"p.M741_T742delinsI"
test<-merge(merged.not.ided, indel, all = T)
test<-unique(test)
test2<-merge(test, nons, all = T)
test2<-unique(test2)
merged.total<-merge(tmp,test2, all = T)
merged.total<-unique(merged.total)
merged.other<-merge(merged.lqt.brs, tmp.other, all = T)
merged.everything<-merge(merged.total, merged.other, all = T)
View(merged.everything)
View(merged.other)
t<-merged.other[is.na(merged.other$var),]
t<-merged.other[is.na(merged.other$ref),]
View(t)
f<-merged.other[merged.other$var=="F1760A",]
f
g<-merged.total[merged.total$var=="F1760A",]
g
f<-merge(f,g)
f
f<-merged.other[merged.other$var=="F1760A",]
g<-merged.total[merged.total$var=="F1760A",]
h<-merge(f,g)
h
h<-merge(f,g, all = T)
h
h<-merge(f,g, all = T, by = "var")
h
View(merged.lqt.brs)
View(tmp.other)
View(tmp)
tmp.total<-rbind(tmp,tmp.other)
View(test2)
View(merged.not.ided)
View(test)
View(indel)
View(test)
View(nons)
View(indel)
View(tmp.total)
View(tmp.total)
indel.total<-rbind(indel,nons)
View(indel.total)
merged.indel<-merge(indel.total,merged.lqt.brs,all = T)
View(merged.indel)
merged.everything<-merge(merged.indel, tmp.total, all = T)
View(merged.everything)
d[d$var=="P2006A",]
library("RSQLite")
setwd("/Users/KRONCKE/Box Sync/Kroncke_Lab/GitHub/Bayes_BrS1_Penetrance/variant_browser/")
con = dbConnect(SQLite(),
dbname="../VariantSCN5A-third-revision.db")
alltables = dbListTables(con)
my.data <- dbReadTable(con, 'VariantSCN5A')
my.data[my.data=='NA'] <- NA
data<-my.data
dbDisconnect(con)
data$gnomAD<-as.integer(data$gnomAD)
data$gnomAD[is.na(data$gnomAD)] <- 0
data$total_carriers<-data$unaff+data$lqt3+data$brs1+data$gnomAD
data[is.na(data$total_carriers),"total_carriers"] <- 0
tmp<-data[data$mut_type %in% c("nucdel_frameshift", "nucins_frameshift", "nonsense",
"nonsene", "frameshift", "splice", "silent_splice",
"indel_splice", "largeDuplication", "largeDeletion",
"unknownSplice", "unknownframeshift", "intronic", "unknown",
"unknownFrameshift", "geneDeletion", "balancedTranslocation",
"stop_retained", "stop_lost", "unknownFrameshift_variant", "aadel", "aains"),
c("var", "lqt3",
"brs1", "unaff", "other")]
tmp.other<-data[!(data$mut_type %in% c("nucdel_frameshift", "nucins_frameshift", "nonsense",
"nonsene", "frameshift", "splice", "silent_splice",
"indel_splice", "largeDuplication", "largeDeletion",
"unknownSplice", "unknownframeshift", "intronic", "unknown",
"unknownFrameshift", "geneDeletion", "balancedTranslocation",
"stop_retained", "stop_lost", "unknownFrameshift_variant", "aadel", "aains", "synonymous")),
c("var", "lqt3",
"brs1", "unaff", "other")]
# Manually Adjust:
tmp<-tmp[tmp$var!="c.2436 +12G>A ", ]
tmp<-tmp[tmp$var!="c.2582_2583delTT", ]
tmp<-tmp[tmp$var!="c.3390-1G>A",]
tmp<-tmp[tmp$var!="	c.3963+2C>T",]
tmp<-tmp[tmp$var!="c.3005_3012delCCAGCTGC",]
tmp[tmp$var=="p.M741_T742delinsI ","var"]<-"p.M741_T742delinsI"
nons<-read.csv("Brett_K_nonsense.csv")
nons<-nons[,c("ref", "pos", "alt", "var")]
nons$var<-as.character(nons$var)
nons$alt<-as.character(nons$alt)
nons$ref<-as.character(nons$ref)
indel<-read.csv("Brett_K_mis_non_indel_splice_adj.csv")
indel<-indel[,c("ref", "pos", "alt", "var")]
indel$var<-as.character(indel$var)
indel$alt<-as.character(indel$alt)
indel$ref<-as.character(indel$ref)
load("CheckPoint_20.RData")
d[is.na(d$var),"var"]<-paste(d[is.na(d$var),"nativeAA"],d[is.na(d$var),"resnum"],d[is.na(d$var),"mutAA"],sep = "")
brs<-d[,c("Structure", "brs1_penetrance", "ref", "pos", "alt", "var", "Function")]
brs$alt<-as.character(brs$alt)
brs$ref<-as.character(brs$ref)
names(brs)[1]<-"Structure_BrS"
load("CheckPoint_20_lqt3.RData")
d[is.na(d$var),"var"]<-paste(d[is.na(d$var),"nativeAA"],d[is.na(d$var),"resnum"],d[is.na(d$var),"mutAA"],sep = "")
lqt<-d[,c("Structure", "lqt3_penetrance", "ref", "pos", "alt", "var", "resnum")]
lqt$alt<-as.character(lqt$alt)
lqt$ref<-as.character(lqt$ref)
names(lqt)[1]<-"Structure_LQT"
merged.lqt.brs<-merge(brs,lqt, all = T)
merged.not.ided<-merged.lqt.brs[is.na(merged.lqt.brs$ref),
c("Structure_BrS", "Structure_LQT", "lqt3_penetrance",
"brs1_penetrance", "Function", "var")]
#merged.lqt.brs<-merged.lqt.brs[!is.na(merged.lqt.brs$ref),]
merged.not.ided[merged.not.ided$var=="p.M741_T742delinsI ","var"]<-"p.M741_T742delinsI"
indel.total<-rbind(indel,nons)
tmp.total<-rbind(tmp,tmp.other)
merged.indel<-merge(indel.total,merged.lqt.brs,all = T)
merged.everything<-merge(merged.indel, tmp.total, all = T)
View(merged.everything)
write.csv(merged.everything, file = "merged.indel.nonsense.csv")
library("RSQLite")
setwd("/Users/KRONCKE/Box Sync/Kroncke_Lab/GitHub/Bayes_BrS1_Penetrance/variant_browser/")
con = dbConnect(SQLite(),
dbname="../VariantSCN5A-third-revision.db")
alltables = dbListTables(con)
my.data <- dbReadTable(con, 'VariantSCN5A')
my.data[my.data=='NA'] <- NA
data<-my.data
dbDisconnect(con)
data$gnomAD<-as.integer(data$gnomAD)
data$gnomAD[is.na(data$gnomAD)] <- 0
data$total_carriers<-data$unaff+data$lqt3+data$brs1+data$gnomAD
data[is.na(data$total_carriers),"total_carriers"] <- 0
tmp<-data[data$mut_type %in% c("nucdel_frameshift", "nucins_frameshift", "nonsense",
"nonsene", "frameshift", "splice", "silent_splice",
"indel_splice", "largeDuplication", "largeDeletion",
"unknownSplice", "unknownframeshift", "intronic", "unknown",
"unknownFrameshift", "geneDeletion", "balancedTranslocation",
"stop_retained", "stop_lost", "unknownFrameshift_variant", "aadel", "aains"),
c("var", "lqt3",
"brs1", "unaff", "other", "gnomAD")]
tmp.other<-data[!(data$mut_type %in% c("nucdel_frameshift", "nucins_frameshift", "nonsense",
"nonsene", "frameshift", "splice", "silent_splice",
"indel_splice", "largeDuplication", "largeDeletion",
"unknownSplice", "unknownframeshift", "intronic", "unknown",
"unknownFrameshift", "geneDeletion", "balancedTranslocation",
"stop_retained", "stop_lost", "unknownFrameshift_variant", "aadel", "aains", "synonymous")),
c("var", "lqt3",
"brs1", "unaff", "other", "gnomAD")]
# Manually Adjust:
tmp<-tmp[tmp$var!="c.2436 +12G>A ", ]
tmp<-tmp[tmp$var!="c.2582_2583delTT", ]
tmp<-tmp[tmp$var!="c.3390-1G>A",]
tmp<-tmp[tmp$var!="	c.3963+2C>T",]
tmp<-tmp[tmp$var!="c.3005_3012delCCAGCTGC",]
tmp[tmp$var=="p.M741_T742delinsI ","var"]<-"p.M741_T742delinsI"
nons<-read.csv("Brett_K_nonsense.csv")
nons<-nons[,c("ref", "pos", "alt", "var")]
nons$var<-as.character(nons$var)
nons$alt<-as.character(nons$alt)
nons$ref<-as.character(nons$ref)
indel<-read.csv("Brett_K_mis_non_indel_splice_adj.csv")
indel<-indel[,c("ref", "pos", "alt", "var")]
indel$var<-as.character(indel$var)
indel$alt<-as.character(indel$alt)
indel$ref<-as.character(indel$ref)
load("CheckPoint_20.RData")
d[is.na(d$var),"var"]<-paste(d[is.na(d$var),"nativeAA"],d[is.na(d$var),"resnum"],d[is.na(d$var),"mutAA"],sep = "")
brs<-d[,c("Structure", "brs1_penetrance", "ref", "pos", "alt", "var", "Function")]
brs$alt<-as.character(brs$alt)
brs$ref<-as.character(brs$ref)
names(brs)[1]<-"Structure_BrS"
load("CheckPoint_20_lqt3.RData")
d[is.na(d$var),"var"]<-paste(d[is.na(d$var),"nativeAA"],d[is.na(d$var),"resnum"],d[is.na(d$var),"mutAA"],sep = "")
lqt<-d[,c("Structure", "lqt3_penetrance", "ref", "pos", "alt", "var", "resnum")]
lqt$alt<-as.character(lqt$alt)
lqt$ref<-as.character(lqt$ref)
names(lqt)[1]<-"Structure_LQT"
merged.lqt.brs<-merge(brs,lqt, all = T)
merged.not.ided<-merged.lqt.brs[is.na(merged.lqt.brs$ref),
c("Structure_BrS", "Structure_LQT", "lqt3_penetrance",
"brs1_penetrance", "Function", "var")]
#merged.lqt.brs<-merged.lqt.brs[!is.na(merged.lqt.brs$ref),]
merged.not.ided[merged.not.ided$var=="p.M741_T742delinsI ","var"]<-"p.M741_T742delinsI"
indel.total<-rbind(indel,nons)
tmp.total<-rbind(tmp,tmp.other)
merged.indel<-merge(indel.total,merged.lqt.brs,all = T)
merged.everything<-merge(merged.indel, tmp.total, all = T)
write.csv(merged.everything, file = "merged.indel.nonsense.csv")
write.csv(merged.everything, file = "merged.indel.nonsense.csv", row.names = F)
library("RSQLite")
setwd("/Users/KRONCKE/Box Sync/Kroncke_Lab/GitHub/Bayes_BrS1_Penetrance/variant_browser/")
con = dbConnect(SQLite(),
dbname="../VariantSCN5A-third-revision.db")
alltables = dbListTables(con)
my.data <- dbReadTable(con, 'VariantSCN5A')
my.data[my.data=='NA'] <- NA
data<-my.data
dbDisconnect(con)
data$gnomAD<-as.integer(data$gnomAD)
data$gnomAD[is.na(data$gnomAD)] <- 0
data$total_carriers<-data$unaff+data$lqt3+data$brs1+data$gnomAD
data[is.na(data$total_carriers),"total_carriers"] <- 0
tmp<-data[data$mut_type %in% c("nucdel_frameshift", "nucins_frameshift", "nonsense",
"nonsene", "frameshift", "splice", "silent_splice",
"indel_splice", "largeDuplication", "largeDeletion",
"unknownSplice", "unknownframeshift", "intronic", "unknown",
"unknownFrameshift", "geneDeletion", "balancedTranslocation",
"stop_retained", "stop_lost", "unknownFrameshift_variant", "aadel", "aains"),
c("var", "lqt3",
"brs1", "unaff", "other", "gnomAD")]
tmp.other<-data[!(data$mut_type %in% c("nucdel_frameshift", "nucins_frameshift", "nonsense",
"nonsene", "frameshift", "splice", "silent_splice",
"indel_splice", "largeDuplication", "largeDeletion",
"unknownSplice", "unknownframeshift", "intronic", "unknown",
"unknownFrameshift", "geneDeletion", "balancedTranslocation",
"stop_retained", "stop_lost", "unknownFrameshift_variant", "aadel", "aains", "synonymous")),
c("var", "lqt3",
"brs1", "unaff", "other", "gnomAD")]
# Manually Adjust:
tmp<-tmp[tmp$var!="c.2436 +12G>A ", ]
tmp<-tmp[tmp$var!="c.2582_2583delTT", ]
tmp<-tmp[tmp$var!="c.3390-1G>A",]
tmp<-tmp[tmp$var!="	c.3963+2C>T",]
tmp<-tmp[tmp$var!="c.3005_3012delCCAGCTGC",]
tmp[tmp$var=="p.M741_T742delinsI ","var"]<-"p.M741_T742delinsI"
nons<-read.csv("Brett_K_nonsense.csv")
nons<-nons[,c("ref", "pos", "alt", "var")]
nons$var<-as.character(nons$var)
nons$alt<-as.character(nons$alt)
nons$ref<-as.character(nons$ref)
indel<-read.csv("Brett_K_mis_non_indel_splice_adj.csv")
indel<-indel[,c("ref", "pos", "alt", "var")]
indel$var<-as.character(indel$var)
indel$alt<-as.character(indel$alt)
indel$ref<-as.character(indel$ref)
load("CheckPoint_20.RData")
d[is.na(d$var),"var"]<-paste(d[is.na(d$var),"nativeAA"],d[is.na(d$var),"resnum"],d[is.na(d$var),"mutAA"],sep = "")
brs<-d[,c("Structure", "brs1_penetrance", "ref", "pos", "alt", "var", "Function")]
brs$alt<-as.character(brs$alt)
brs$ref<-as.character(brs$ref)
names(brs)[1]<-"Structure_BrS"
load("CheckPoint_20_lqt3.RData")
d[is.na(d$var),"var"]<-paste(d[is.na(d$var),"nativeAA"],d[is.na(d$var),"resnum"],d[is.na(d$var),"mutAA"],sep = "")
lqt<-d[,c("Structure", "lqt3_penetrance", "ref", "pos", "alt", "var", "resnum")]
lqt$alt<-as.character(lqt$alt)
lqt$ref<-as.character(lqt$ref)
names(lqt)[1]<-"Structure_LQT"
merged.lqt.brs<-merge(brs,lqt, all = T)
merged.not.ided<-merged.lqt.brs[is.na(merged.lqt.brs$ref),
c("Structure_BrS", "Structure_LQT", "lqt3_penetrance",
"brs1_penetrance", "Function", "var")]
merged.not.ided[merged.not.ided$var=="p.M741_T742delinsI ","var"]<-"p.M741_T742delinsI"
indel.total<-rbind(indel,nons)
tmp.total<-rbind(tmp,tmp.other)
merged.indel<-merge(indel.total,merged.lqt.brs,all = T)
merged.everything<-merge(merged.indel, tmp.total, all = T)
merged.everything$total_carriers<-0
merged.everything$total_carriers<-merged.everything$lqt3+
merged.everything$brs1+
merged.everything$unaff+
merged.everything$gnomAD
merged.everything$unaff_gnomad<-merged.everything$unaff+merged.everything$gnomAD
merged.everything<-merged.everything[,]
write.csv(merged.everything, file = "merged.indel.nonsense.csv", row.names = F)
View(merged.everything)
clear
knitr::opts_chunk$set(echo = TRUE)
library("nnet")
library("DBI")
library("RSQLite")
library(dplyr)
library(ggplot2)
library(ggpubr)
library(caret)
library(plotrix)
library(glmnet)
library(meta)
library(reshape2)
library(psych)
require(Hmisc)
library(tableone)
library(wCorr)
library(rms)
library(boot)
library(leaps)
library(car)
library(reticulate)
library(rootSolve)
library(pROC)
library(wCorr)
library(MALDIquant)
library(tidyverse)      # data manipulation and visualization
library(lubridate)      # easily work with dates and times
library(fpp2)           # working with time series data
library(zoo)            # working with time series data
library(latex2exp)
library(forestplot)
library(ggplot2)
setwd("/Users/KRONCKE/Box Sync/Kroncke_Lab/GitHub/Bayes_KCNH2_LQT2_Penetrance/")
source('func_dist_seq.R')
load("prepared_data.RData")
# Include distances between residue centroids from the structure of KV11.1 (KCNH2 protein product) PDB-ID: 5VA1
h2dist<-read.csv(file = "5va1.dists.txt", header = FALSE)
# Loading combined literature, gnomAD, and cohort dataset
load("lit_all_data_checkpoint.RData")
